//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
var FBInstant={options:{apiKey:"",// Game service back-end API key
apiSecret:"",// Game service back-end API secret
devMode:"sandbox",// sandbox or prod
container:null,// Container element
shareOptions:{// Ads service options
shareURI:"",// URI used by shareAsync dialog
dlgWidth:600,// shareAsync dialog width
dlgHeignht:400// shareAsync dialog height
},adsOptions:{},// Ads service options
paymentsOptions:{},// Payments service options
analyticsOptions:{},// Analytics service options
storageOptions:{},// Storage service options
userOptions:{// User service options
allowAnonymous:!0// When set to true new users will be auto logged in with an anonymous account
},messagingOptions:{},// Messaging service options
leaderboardsOptions:{},// Leaderboard service options
referralsOptions:{},// Referral service options
chatOptions:{}// Chat service options
},supportedAPIs:["initializeAsync","setLoadingProgress","startGameAsync","getEntryPointData"],__state:{initialized:!1,purchasingReadyCallback:null,platform:"WEB"},Log:function(e){console.log(e)},player:{getName:function(){var e=UserService.instance.GetProfileData();return null===e?null:e.name},getPhoto:function(){var e=UserService.instance.GetProfileData();return null===e?null:e.photo===void 0?null:e.photo},getID:function(){var e=UserService.instance.GetProfileData();return null===e||void 0===e?null:e.id},getDataAsync:function(e){return new Promise(function(t){if(StorageService.instance!==void 0)StorageService.instance.GetUserData("userData",function(a){var s={};null===a?(a=localStorage.getItem("userData"),a=JSON.parse(a)):localStorage.setItem("userData",JSON.stringify(a)),null!==a&&e.forEach(function(e){"undefined"!==a[e]&&(s[e]=a[e])}),t(s)});else{var a={},s=localStorage.getItem("userData");s=JSON.parse(s),null!==s&&e.forEach(function(e){"undefined"!==s[e]&&(a[e]=s[e])}),t(a)}})},setDataAsync:function(e){return new Promise(function(t){var a=localStorage.getItem("userData"),s=JSON.parse(a);for(var n in(void 0===s||null==s)&&(s={}),e)s[n]=e[n];localStorage.setItem("userData",JSON.stringify(s)),void 0===StorageService.instance?t():StorageService.instance.SetUserData("userData",JSON.stringify(s),function(){t()})})},getStatsAsync:function(){// TODO:
},setStatsAsync:function(){return new Promise(function(e){e()})},incrementStatsAsync:function(){// TODO:
},flushDataAsync:function(){// TODO:
},getConnectedPlayersAsync:function(){return new Promise(function(e){UserService.instance.GetFriends(function(t){e(t)})})},getSignedPlayerInfoAsync:function(){// TODO:
return new Promise(function(e){e(null)})},canSubscribeBotAsync:function(){// TODO:
return new Promise(function(e){e(!1)})},subscribeBotAsync:function(){// TODO:
return new Promise(function(e){e(null)})}},context:{getID:function(){return null},chooseAsync:function(){// TODO:
return new Promise(function(e){e()})},switchAsync:function(){// TODO:
return new Promise(function(e){e()})},createAsync:function(){// TODO:
return new Promise(function(e){e()})},getType:function(){// TODO:
return"SOLO"},isSizeBetween:function(){// TODO:
return!0},getPlayersAsync:function(){// TDOO:
return new Promise(function(e){e([])})}},payments:{getCatalogAsync:function(){return new Promise(function(e,t){PaymentsService.instance.GetProducts(function(a,s){null===a?e(s):t(a)})})},purchaseAsync:function(e){return new Promise(function(t,a){PaymentsService.instance.PurchaseProduct(e,function(e,s){null===e?t(s):a(e)})})},getPurchasesAsync:function(){return new Promise(function(e,t){PaymentsService.instance.GetPurchases(function(a,s){null===a?e(s):t(a)})})},consumePurchaseAsync:function(e){return new Promise(function(t,a){PaymentsService.instance.ConsumeProduct(e,function(e){null===e?t():a(e)})})},onReady:function(e){FBInstant.__state.purchasingReadyCallback=e}},getSupportedAPIs:function(){return FBInstant.supportedAPIs},getLocale:function(){var e=UserService.instance.GetProfileData();return null===e?LibUtils.GetLocale():e.lang+"_"},initializeAsync:function(){return new Promise(function(e){var t=FBInstant.options;FBInstant.Log(">>>> initializeAsync"),GameService.instance.Init(t),StorageService.instance!==void 0&&StorageService.instance.InitStorage(t.storageOptions),UserService.instance!==void 0&&UserService.instance.InitUser(t.usersOptions),AnalyticsService.instance!==void 0&&AnalyticsService.instance.InitAnalytics(t.analyticsOptions),MessagingService.instance!==void 0&&MessagingService.instance.InitMessaging(t.messagingOptions),ShareService.instance!==void 0&&ShareService.instance.InitShare(t.shareOptions),LeaderboardsService.instance!==void 0&&LeaderboardsService.instance.InitLeaderboards(t.leaderboardsOptions),AdsService.instance!==void 0&&AdsService.instance.InitAds(t.adsOptions),ReferralService.instance!==void 0&&ReferralService.instance.InitReferrals(t.referralsOptions),ChatService.instance!==void 0&&ChatService.instance.InitChat(t.chatOptions),PaymentsService.instance!==void 0&&PaymentsService.instance.InitPayments(t.paymentsOptions,function(e){null===e&&null!==FBInstant.__state.purchasingReadyCallback&&FBInstant.__state.purchasingReadyCallback()}),e()})},setLoadingProgress:function(e){return new Promise(function(t){GameService.instance&&GameService.instance.service&&GameService.instance.service.SetLoadingProgress&&GameService.instance.service.SetLoadingProgress(e),t()})},startGameAsync:function(){return new Promise(function(e,t){FBInstant.Log(">>>> startGameAsync"),GameService.instance&&GameService.instance.service&&GameService.instance.service.FinishedLoading&&GameService.instance.service.FinishedLoading(),UserService.instance.Login(FBInstant.options.userOptions.allowAnonymous,function(a){null===a?(FBInstant.__state.initialized=!0,FBInstant.Log(">> Login success"),e()):(FBInstant.Log(">> Login failed"),t())})})},quit:function(){// TODO:
},updateAsync:function(){// TODO:
return new Promise(function(e){e()})},getEntryPointData:function(){FBInstant.Log(">>>> getEntryPointData");var e=window.location.search;e.startsWith("?")&&(e=e.substring(1));for(var a=e.split("&"),s=0;s<a.length;s++)if(a[s].startsWith("data")){var n=a[s].split("=");return void 0!==n[1]&&""!==n[1]&&(e=decodeURIComponent(n[1]),e=JSON.parse(e),FBInstant.Log(e)),void 0===e?null:e}return null},getEntryPointAsync:function(){// TODO:
return new Promise(function(e){e("admin_message")})},setSessionData:function(){// TODO:
},getPlatform:function(){return FBInstant.__state.platform},getSDKVersion:function(){return"6.2"},postSessionScore:function(){// TODO: Will be part of lib_leaderboardservice
},shareAsync:function(e){return new Promise(function(t,a){ShareService.instance===void 0?a({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"}):(ShareService.instance.SharePrimary(e),t())})},switchGameAsync:function(){return Promise.reject(new Error("Not available"))},logEvent:function(e,t,a){return void 0===AnalyticsService.instance?{code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"}:AnalyticsService.instance.LogEvent(e,t,a)},onPause:function(e){window.onblur=function(){e()}},canCreateShortcutAsync:function(){return Promise.resolve(!1)},Leaderboard:function(e){this.name=e},getLeaderboardAsync:function(e,t){return new Promise(function(a){var s=new FBInstant.Leaderboard(e);t===void 0&&(t={}),s.options=t,a(s)})},AdInstance:function(e,t){this.id=e,this.type=t},getInterstitialAdAsync:function(e){return void 0===AdsService.instance?void 0:new Promise(function(t,a){AdsService.instance.IsSupported(e,"inter")?t(new FBInstant.AdInstance(e,"inter")):a({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})})},getRewardedVideoAsync:function(e){return void 0===AdsService.instance?void 0:new Promise(function(t,a){AdsService.instance.IsSupported(e,"video")?t(new FBInstant.AdInstance(e,"video")):a({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})})},createDefaultServices:function(e){"xtralife"===e?(new GameService(e),new StorageService(e),new UserService(e),new LeaderboardsService(e),new MessagingService(e),new ReferralService(e),new ShareService("generic")):"unity"===e?(new GameService(e),new UserService(e),new AnalyticsService(e),new LeaderboardsService(e),new PaymentsService(e),new AdsService(e),new ShareService(e),new DebugService(e)):"kongregate"===e?(new GameService(e),new UserService(e),new AnalyticsService(e),new PaymentsService(e),new ShareService(e),new ChatService(e)):"poki"===e?(new GameService(e),new UserService("none"),new AdsService(e),new ShareService("generic")):"none"==e&&(new GameService(e),new UserService(e),new ShareService("generic"))},matchPlayerAsync:function(){// TODO: Will be part of lib_matchmakingservice
return new Promise(function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})})},checkCanPlayerMatchAsync:function(){// TODO: Will be part of lib_matchmakingservice
return new Promise(function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})})}};FBInstant.AdInstance.prototype.getPlacementID=function(){return this.id},FBInstant.AdInstance.prototype.loadAsync=function(){if(void 0!==AdsService.instance){var e=this;return new Promise(function(t,a){AdsService.instance.PreloadAd(e.id,e.type,function(e){null===e?t():a(e)})})}},FBInstant.AdInstance.prototype.showAsync=function(){if(void 0!==AdsService.instance){var e=this;return new Promise(function(t,a){AdsService.instance.ShowAd(e.id,e.type,function(e){null===e?t():a(e)})})}},FBInstant.Leaderboard.prototype.getEntriesAsync=function(e,t){if(void 0!==LeaderboardsService.instance){var a=this;return new Promise(function(s){LeaderboardsService.instance.LeaderboardGetPaged(a,a.name,(0|t/e)+1,e,function(e){s(e)})})}},FBInstant.Leaderboard.prototype.getConnectedPlayerEntriesAsync=function(e,t){if(void 0!==LeaderboardsService.instance){var a=this;return new Promise(function(s){LeaderboardsService.instance.LeaderboardGetFriendsPaged(a,a.name,(0|t/e)+1,e,function(e){s(e)})})}},FBInstant.Leaderboard.prototype.getPlayerEntryAsync=function(){if(void 0!==LeaderboardsService.instance){var e=this;return new Promise(function(t){LeaderboardsService.instance.LeaderboardGetRank(e,e.name,function(e){t(e)})})}},FBInstant.Leaderboard.prototype.setScoreAsync=function(e,t){if(void 0!==LeaderboardsService.instance){var a=this;return new Promise(function(s){LeaderboardsService.instance.LeaderboardSetScore(a,a.name,e,t,function(e){s(e)})})}},FBInstant.ext={/**
     * Checks to see if the user is logged in
     * @return true if logged in
     */isLoggedIn:function(){return void 0!==UserService.instance&&null!==UserService.instance.GetGamerData()},/**
     * Gets the login type, e.g. anonymous, email, facebook etc..
     * @return Login network type
     */getLoginType:function(){var e=UserService.instance.GetGamerData();return e?e.network:"none"},/**
     * Gets the date / time that the user first registered
     * @return List of games
     */getRegistrationDate:function(){var e=UserService.instance.GetGamerData();return e?e.registerTime:null},/**
     * Logs the player in with the supplied shortcode
     * @param shortcode {string} The Game service shortcode (sent by password reset usually)
     * @return error or null if no error, gamer contains the gamers data
     */loginWithShortCodeAsync:function(e){return new Promise(function(t){UserService.instance.LoginWithShortCode(e,function(e,a){t(e,a)})})},/**
     * Logs the player in using the default login (anonymously usually)
     * @return error or null if no error, gamer contains the gamers data
     */loginAsync:function(){return new Promise(function(e,t){UserService.instance.Login(FBInstant.options.userOptions.allowAnonymous,function(a){a?(FBInstant.Log(">> Login failed"),t()):(FBInstant.Log(">> Login success"),e())})})},/**
     * Logs the player in with an email and password
     * @param email {string} The users email address
     * @param password {string} The users password
     * @param options {object} Login options
     * @return error or null if no error, gamer contains the gamers data
     */loginWithEmailAsync:function(e,t,a){return new Promise(function(s,n){UserService.instance.LoginWithCredentials(e,t,a,function(e){e?(FBInstant.Log(">> Login with email failed"),n()):(FBInstant.Log(">> Login with email success"),s())})})},/**
     * Logs the player in with the supplied Facebook access token
     * @param facebook_access_token {string} The Facebook access token, this can be retrieved from response.authResponse.accessToken in the FB.getLoginStatus() callback
     * @return error or null if no error, gamer contains the gamers data
     */loginWithFacebookAccessTokenAsync:function(e){return new Promise(function(t){UserService.instance.LoginWithFacebook(e,function(e,a){t(e,a)})})},/**
     * Logs the player out
     * @return error or null if no error
     */logoutAsync:function(){return new Promise(function(e){UserService.instance.Logout(function(t){e(t)})})},/**
     * Converts an anonymous account to an email or social network account
     * @param network {string} Type of network to convert account to, email, facebook etc..
     * @param username_or_id {string} Email address for email or ID for Facebook
     * @param password_or_secret {string} Password for email or token for Facebook
     * @return error or null if no error
     */convertAccountAsync:function(e,t,a){return new Promise(function(s){UserService.instance.ConvertAccount(e,t,a,function(e){s(e)})})},/**
     * Associates a social network account with a game service account
     * @param network {string} Type of network to convert account to, facebook, googleplus etc..
     * @param id {string} ID for Facebook
     * @param secret {string} Token for Facebook
     * @return error or null if no error
     */linkAccountAsync:function(e,t,a){return new Promise(function(s){UserService.instance.LinkAccount(e,t,a,function(e){s(e)})})},/**
     * Sends an email to the players account with a shortcode that can be used to login
     * @param to_email {string} Users emali address
     * @param from_email {string} Your company support email address
     * @param title {string} Email title
     * @param body {Object} Email body, e.g. { body: "You can login with this <b>[[SHORTCODE]]</b>", html: true };
     * @return error or null if no error
     */resetPasswordAsync:function(e,t,a,s){return new Promise(function(n){UserService.instance.ResetPassword(e,t,a,s,function(e){n(e)})})},/**
     * Changes the users account password
     * @param new_password {string} New password
     * @return error or null if no error
     */changePasswordAsync:function(e){return new Promise(function(t){UserService.instance.ChangePassword(e,function(e){t(e)})})},/**
     * Gets list of games that the user has played
     * @return List of games
     */getGames:function(){return UserService.instance.GetGames()},/**
     * Sets the players profile data
     * @param profile {object} An object containing profile fields and data
     * @return error or null if no error
     */setProfileAsync:function(e){return new Promise(function(t){UserService.instance.SetProfile(e,function(e){t(e)})})},/**
     * Adds a user as a friend
     * @param id {string} User ID of user to add as a friend
     * @return true if success
     */addFriendAsync:function(e){return new Promise(function(t){UserService.instance.AddFriend(e,function(e){console.log(">>>>> addFriendAsync "+e),t(e)})})},/**
     * Removes a user as a friend
     * @param id {string} User ID of user to unfriend
     * @return true if success
     */removeFriendAsync:function(e){return new Promise(function(t){UserService.instance.RemoveFriend(e,function(e){t(e)})})},/**
     * Searches for users using a pattern
     * @param match_pattern {string} A filter used to search for players
     * @param start {number} Index of first user to be returned
     * @param limit {number} Max number of users to return
     * @return List of found users or null if error
     */listUsersAsync:function(e,t,a){return new Promise(function(s){UserService.instance.ListUsers(e,t,a,function(e){s(e)})})},/**
     * Send event to another user
     * @param id {string} User ID of user to receive event
     * @param evt {object} Event object to send
     * @return true if success
     */sendEventAsync:function(e,t){return new Promise(function(a){MessagingService.instance.SendEvent(e,t,function(e){a(null===e)})})},/**
     * Collects any pending events
     * @return array of events or null if none
     */getEventsAsync:function(){return new Promise(function(e){MessagingService.instance.GetAllEvents(function(t){e(t)})})},/**
     * Get a generated referral code
     * @return a referral code or null if failed
     */getReferralCodeAsync:function(){return new Promise(function(e){ReferralService.instance.GetReferralCode(function(t){e(t)})})},/**
     * Consume a referral code
     * @return true if success
     */useReferralCodeAsync:function(e){return new Promise(function(t){ReferralService.instance.UseReferralCode(e,function(e){t(e)})})},/**
     * Share on Twitter
     * @param options {object} message options, only text is supported at this time
     */shareTwitterAsync:function(e){return new Promise(function(t){ShareService.instance.ShareService(e),t()})},/**
     * Get a sharable url
     * @param options {object} message options, only data is supported at this time
     */getShareURLAsync:function(e){return new Promise(function(t){t(ShareService.instance.GetShareURL(e))})},/**
     * Opens an external URL in a new window
     * @param options {object} contains url
     */openExternalURL:function(e){return new Promise(function(t,a){ShareService.instance===void 0?a({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"}):(ShareService.instance.OpenURL(e),t())})},/**
     * Send a chat message
     * @param options {object} chat options
     */chatSendAsync:function(e){return new Promise(function(t){ChatService.instance.SendChatMessage(e),t()})},/**
     * Start a chat
     * @param options {object} chat options
     */chatStartAsync:function(e){return new Promise(function(t){ChatService.instance.StartChat(e),t()})},/**
     * End a chat
     * @param options {object} chat options
     */chatEndAsync:function(e){return new Promise(function(t){ChatService.instance.EndChat(e),t()})},/**
     * Show leaderboard UI
     */showLeaderboard:function(e){LeaderboardsService.instance.ShowLeaderboard(e)},/**
     * Game event messages
     */gameEvent:function(e){GameService.instance&&GameService.instance.service&&GameService.instance.service.GameEvent&&GameService.instance.service.GameEvent(e)},debug:{/*
        * Show debug window
        */show:function(e){DebugService.instance.Show(e)},/*
        * Clear debug window
        */clear:function(){DebugService.instance.Clear()},/*
        * Log text to the debug window
        */log:function(e){DebugService.instance.Log(e)}}},"use strict";var WebUtils={};//
// Shares
//
// CSS
/*
body {
    background-color: #201020;
}

#igx_share_container
{
	display: block;
	visibility: hidden;
	width:70%;
	height:50%;
	top:10%;
	left:15%;
	position: absolute;
	background-color: rgb(255, 255, 255);
	text-align: center;
	font-size: 2em;
	font-family: Arial;
	border-radius: 25px;
	border:2px solid black;
}

#igx_name_text
{
	color: black;
}
*/WebUtils.CreateShareUI=function(e){var t=document.createElement("div");t.id="igx_share_container";var a=document.createElement("div");a.id="igx_share",a.className="container";var s=document.createElement("div");s.className="row";var n=document.createElement("div");n.className="row";var r=document.createElement("div");r.className="row";var o=document.createElement("div");o.className="row";var i=document.createElement("hr"),d=document.createElement("h1");d.id="igx_title";var c=document.createElement("input");c.id="igx_url",c.type="text";var p=document.createElement("hr"),g=document.createElement("button");g.id="igx_copy_button",g.className="btn btn-success btn-lg",g.innerText="Copy",t.appendChild(a),a.appendChild(s),a.appendChild(n),a.appendChild(r),a.appendChild(o),s.appendChild(i),s.appendChild(d),n.appendChild(c),r.appendChild(p),o.appendChild(g),e||(e="gamecanvas");document.getElementById(e);document.body.appendChild(t),WebUtils.ShareUICreated=!0},WebUtils.ShareDataURL=function(e,t,a){e=e?{data:e}:{},FBInstant.ext.getShareURLAsync(e).then(function(e){WebUtils.ShowShareLink(!0,e,t),a!==void 0&&a(e)})},WebUtils.ShowShareLink=function(e,t,a){WebUtils.ShareUICreated||WebUtils.CreateShareUI();var s=document.getElementById("igx_share_container"),n=document.getElementById("igx_title"),r=document.getElementById("igx_url"),o=document.getElementById("igx_copy_button");n.innerText=a,r.value=t,e?(s.style.visibility="visible",o.onclick=function(){WebUtils.CopyToClipboard(t),s.style.visibility="hidden"}):(okbutton.onclick=void 0,s.style.visibility="hidden")},WebUtils.CopyToClipboard=function(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)},WebUtils.SendShareInvite=function(e){e||(e="Share the url below to invite friends to play."),WebUtils.ShareDataURL(void 0,e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
var LibUtils={Log:function(e){console.log(e)},LogError:function(e){console.log(e)},ResolveService:function(e){if(GameService.instance!==void 0&&GameService.instance.name===e)return GameService.instance.service;return void 0!==UserService.instance&&UserService.instance.name===e?UserService.instance.service:void 0!==LeaderboardsService.instance&&LeaderboardsService.instance.name===e?LeaderboardsService.instance.service:void 0!==MessagingService.instance&&MessagingService.instance.name===e?MessagingService.instance.service:void 0!==ReferralService.instance&&ReferralService.instance.name===e?ReferralService.instance.service:void 0!==StorageService.instance&&StorageService.instance.name===e?StorageService.instance.service:void 0!==AnalyticsService.instance&&AnalyticsService.instance.name===e?AnalyticsService.instance.service:void 0!==AdsService.instance&&AdsService.instance.name===e?AdsService.instance.service:void 0!==PaymentsService.instance&&PaymentsService.instance.name===e?PaymentsService.instance.service:void 0!==ChatService.instance&&ChatService.instance.name===e?ChatService.instance.service:void 0!==DebugService.instance&&DebugService.instance.name===e?DebugService.instance.service:void 0},GetLocale:function(){var e=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;return e?e.replace("-","_"):"en_US"}//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
},LibSocial={Log:function(e){console.log(e)},LogError:function(e){console.log(e)},Facebook:{StatusChangeCallback:void 0,Init:function(e,t){window.fbAsyncInit=function(){FB.init({appId:e,autoLogAppEvents:!0,xfbml:!0,version:"v3.1"}),FB.getLoginStatus(function(e){t!==void 0&&t(e)})},function(e,a,s){var n,r=e.getElementsByTagName(a)[0];return e.getElementById(s)?void(void 0!==t&&t({status:"Facebook SDK already loaded"})):void(n=e.createElement(a),n.id=s,n.src="https://connect.facebook.net/en_US/sdk.js",r.parentNode.insertBefore(n,r))}(document,"script","facebook-jssdk")},Login:function(e){FB.login(function(t){e!==void 0&&e(t)},{scope:"public_profile,email"})},GetProfile:function(e){FB.api("/me",function(t){e!==void 0&&e(t)})},Logout:function(e){FB.logout(function(t){e!==void 0&&e(t)})}}//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
};function GameService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("xtralife"===e?this.service=new LibXtralife:"kongregate"===e?this.service=new LibKongregate:"unity"===e?this.service=new LibUnity:"poki"==e&&(this.service=new LibPoki)),this.name=e,GameService.instance=this}//
// INIT
//
GameService.prototype.Init=function(e){return void 0===this.service?void 0:this.service.Init(e)},GameService.prototype.SetLoadingProgress=function(e){return this.service&&this.service.SetLoadingProgress?this.service.SetLoadingProgress(e):void 0},GameService.prototype.FinishedLoading=function(e){return this.service&&this.service.FinishedLoading?this.service.FinishedLoading(e):void 0};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function UserService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("xtralife"===e?this.service=new LibXtralife:"kongregate"===e?this.service=new LibKongregate:"unity"==e&&(this.service=new LibUnity)),this.name=e,UserService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("user")}UserService.Player=function(e,t,a,s,n){this.id=e,this.name=t,this.photo=a,this.email=s,this.lang=n,this.getName=function(){return this.name},this.getPhoto=function(){return this.photo===void 0?null:this.photo},this.getID=function(){return this.id},this.getEmail=function(){return this.email},this.getLanguage=function()// None standard IG
{return this.lang}},UserService.Game=function(e,t,a,s,n){this.id=e,this.name=t,this.login=a,this.icon=s,this.location=n},UserService.prototype.InitUser=function(e){return void 0===this.service?void 0:this.service.InitUser(e)},UserService.prototype.IsSupported=function(){return this.service!==void 0},UserService.prototype.Login=function(e,t){return void 0===this.service?void(void 0!==t&&t(null,null)):this.service.Login(e,t)},UserService.prototype.ResumeSession=function(e,t,a){return void 0===this.service?void(void 0!==a&&a({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "},null)):this.service.ResumeSession(e,t,a)},UserService.prototype.LoginWithCredentials=function(e,t,a,s){return void 0===this.service?void(void 0!==s&&s({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "},null)):this.service.LoginWithCredentials(e,t,a,s)},UserService.prototype.LoginWithShortCode=function(e,t){return void 0===this.service?void(void 0!==t&&t({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "},null)):this.service.LoginWithShortCode(e,t)},UserService.prototype.LoginWithFacebook=function(e,t){return void 0===this.service?void(void 0!==t&&t({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "},null)):this.service.LoginWithFacebook(e,t)},UserService.prototype.Logout=function(e){return void 0===this.service?void(void 0!==e&&e(null)):this.service.Logout(e)},UserService.prototype.ConvertAccount=function(e,t,a,s){return void 0===this.service?void(void 0!==s&&s({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.ConvertAccount(e,t,a,s)},UserService.prototype.LinkAccount=function(e,t,a,s){return void 0===this.service?void(void 0!==s&&s({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.LinkAccount(e,t,a,s)},UserService.prototype.ResetPassword=function(e,t,a,s,n){return void 0===this.service?void(void 0!==n&&n({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.ResetPassword(e,t,a,s,n)},UserService.prototype.ChangePassword=function(e,t){return void 0===this.service?void(void 0!==t&&t({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.ChangePassword(e,t)},UserService.prototype.GetGamerData=function(){return void 0===this.service?null:this.service.GetGamerData()},UserService.prototype.GetProfileData=function(){return void 0===this.service?null:this.service.GetProfileData()},UserService.prototype.GetProfile=function(e){return void 0===this.service?void(void 0!==e&&e({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.GetProfile(e)},UserService.prototype.SetProfile=function(e,t){return void 0===this.service?void(void 0!==t&&t({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.SetProfile(e,t)},UserService.prototype.GetGames=function(){return void 0===this.service?null:this.service.GetGames()},UserService.prototype.ListUsers=function(e,t,a,s){return void 0===this.service?void(void 0!==s&&s(null)):this.service.ListUsers(e,t,a,s)},UserService.prototype.GetFriends=function(e){return void 0===this.service?void(void 0!==e&&e(null)):this.service.GetFriends(e)},UserService.prototype.AddFriend=function(e,t){return void 0===this.service?void(void 0!==t&&t(!1)):this.service.AddFriend(e,t)},UserService.prototype.RemoveFriend=function(e,t){return void 0===this.service?void(void 0!==t&&t(!1)):this.service.RemoveFriend(e,t)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function StorageService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&"xtralife"===e&&(this.service=new LibXtralife),this.name=e,StorageService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("storage")}//
// INIT
//
StorageService.prototype.InitStorage=function(e){return void 0===this.service?void 0:this.service.InitStorage(e)},StorageService.prototype.IsSupported=function(){return this.service!==void 0},StorageService.prototype.SetUserData=function(e,t,a){return void 0===this.service?void(void 0!==a&&a(!1)):this.service.SetUserData(e,t,a)},StorageService.prototype.GetUserData=function(e,t){return void 0===this.service?void(void 0!==t&&t(null)):this.service.GetUserData(e,t)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LeaderboardsService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("xtralife"===e?this.service=new LibXtralife:"unity"==e&&(this.service=new LibUnity)),this.name=e,LeaderboardsService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("leaderboards")}LeaderboardsService.LbdEntry=function(e,t,a,s,n,r,o){this.id=e,this.rank=t,this.name=a,this.score=s,this.extra=n,this.photo=r,this.timestamp=o,this.getPlayer=function(){var e=this;return{rank:this.rank,getName:function(){return e.name},getPhoto:function(){return e.photo===void 0?null:e.photo},getID:function(){return e.id}}},this.getRank=function(){return this.rank},this.getScore=function(){return this.score},this.getExtraData=function(){return this.extra},this.getTimestamp=function(){return this.timestamp}},LeaderboardsService.prototype.InitLeaderboards=function(e){return void 0===this.service?void 0:this.service.InitLeaderboards(e)},LeaderboardsService.prototype.IsSupported=function(){return this.service!==void 0},LeaderboardsService.prototype.LeaderboardGetPaged=function(e,t,a,s,n){return void 0===this.service?void(void 0!==n&&n(null)):this.service.LeaderboardGetPaged(e,t,a,s,n)},LeaderboardsService.prototype.LeaderboardGetFriendsPaged=function(e,t,a,s,n){return void 0===this.service?void(void 0!==n&&n(null)):this.service.LeaderboardGetFriendsPaged(e,t,a,s,n)},LeaderboardsService.prototype.LeaderboardGetRank=function(e,t,a){return void 0===this.service?void(void 0!==a&&a(null)):this.service.LeaderboardGetRank(e,t,a)},LeaderboardsService.prototype.LeaderboardSetScore=function(e,t,a,s,n){return void 0===this.service?void(void 0!==n&&n(!1)):this.service.LeaderboardSetScore(e,t,a,s,n)},LeaderboardsService.prototype.ShowLeaderboard=function(e){return void 0===this.service?void(void 0!==done_cb&&done_cb(!1)):this.service.ShowLeaderboard(e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function MessagingService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&"xtralife"===e&&(this.service=new LibXtralife),this.name=e,MessagingService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("messaging")}//
// INIT
//
MessagingService.prototype.InitMessaging=function(e){return void 0===this.service?void 0:this.service.InitMessaging(e)},MessagingService.prototype.IsSupported=function(){return this.service!==void 0},MessagingService.prototype.SendEvent=function(e,t,a){return void 0===this.service?void(void 0!==a&&a({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.SendEvent(e,t,a)},MessagingService.prototype.ListenForEvent=function(e){return void 0===this.service?void(void 0!==e&&e({code:"CLIENT_UNSUPPORTED_OPERATION ",message:"CLIENT_UNSUPPORTED_OPERATION "})):this.service.ListenForEvent(e)},MessagingService.prototype.GetAllEvents=function(e){return void 0===this.service?void(void 0!==e&&e(null)):this.service.GetAllEvents(e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function ReferralService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&"xtralife"===e&&(this.service=new LibXtralife),this.name=e,ReferralService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("referrals")}//
// INIT
//
ReferralService.prototype.InitReferrals=function(e){return void 0===this.service?void 0:this.service.InitReferrals(e)},ReferralService.prototype.IsSupported=function(){return this.service!==void 0},ReferralService.prototype.GetReferralCode=function(e){return void 0===this.service?void(void 0!==e&&e(null)):this.service.GetReferralCode(e)},ReferralService.prototype.UseReferralCode=function(e,t){return void 0===this.service?void(void 0!==t&&t(!1)):this.service.UseReferralCode(e,t)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function ShareService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("generic"===e?this.service=new LibGeneric:"kongregate"===e?this.service=new LibKongregate:"unity"==e&&(this.service=new LibUnity)),this.name=e,ShareService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("share")}//
// INIT
//
ShareService.prototype.InitShare=function(e){return void 0===this.service?void 0:this.service.InitShare(e)},ShareService.prototype.IsSupported=function(){return this.service!==void 0},ShareService.prototype.SharePrimary=function(e){return void 0===this.service?void 0:this.service.SharePrimary(e)},ShareService.prototype.ShareFacebook=function(e){var t=FBInstant.options.shareOptions,a=e.title===void 0?"":e.title,s=e.text,n=encodeURIComponent(t.shareURI+"?t="+a+"&d="+s);e.data!==void 0&&(n+="&data="+JSON.stringify(e.data)),window.open("https://www.facebook.com/sharer/sharer.php?u="+n,"pop","width="+t.dlgWidth+", height="+t.dlgHeight+", scrollbars=no")},ShareService.prototype.ShareTwitter=function(e){var t=FBInstant.options.shareOptions,a=e.text,s=encodeURIComponent(a);window.open("https://twitter.com/intent/tweet?text="+s,"pop","width="+t.dlgWidth+", height="+t.dlgHeight+", scrollbars=no")},ShareService.prototype.GetShareURL=function(e){var t=FBInstant.options.shareOptions,a=t.shareURI;return void 0!==e.data&&(a+="?data="+encodeURIComponent(JSON.stringify(e.data))),a},ShareService.prototype.OpenURL=function(e){return void 0===this.service?void 0:this.service.OpenURL(e)},ChatService.Message=function(e,t,a,s){this.message=e,this.user=t,this.method=a,this.room=s,this.time=Date.now};function ChatService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&"kongregate"===e&&(this.service=new LibKongregate),this.name=e,ChatService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("chat")}//
// INIT
//
ChatService.prototype.InitChat=function(e){return void 0!==this.service&&this.service.InitChat(e)},ChatService.prototype.IsSupported=function(){return this.service!==void 0},ChatService.prototype.StartChat=function(e){return void 0!==this.service&&this.service.StartChat(e)},ChatService.prototype.EndChat=function(e){return void 0!==this.service&&this.service.EndChat(e)},ChatService.prototype.SendChatMessage=function(e){return void 0!==this.service&&this.service.SendChatMessage(e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function DebugService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&"unity"===e&&(this.service=new LibUnity),this.name=e,DebugService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("debug")}DebugService.prototype.Show=function(e){return void 0===this.service?void 0:this.service.ShowDebug(e)},DebugService.prototype.Clear=function(){return void 0===this.service?void 0:this.service.ClearDebug()},DebugService.prototype.Log=function(e){return void 0===this.service?void 0:this.service.LogDebug(e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibGeneric(){// NOTES:
}LibGeneric.Log=function(e){console.log(e)},LibGeneric.LogError=function(e){console.log(e)},LibGeneric.prototype.InitShare=function(){},LibGeneric.prototype.addSupportedAPI=function(e){"share"===e&&(FBInstant.supportedAPIs.push("shareAsync"),FBInstant.supportedAPIs.push("ext.shareTwitterAsync"),FBInstant.supportedAPIs.push("ext.GetShareURL"))},LibGeneric.prototype.SharePrimary=function(e){//ShareService.instance.ShareFacebook(options);
WebUtils.ShareDataURL(e.data,e.text)},LibGeneric.prototype.OpenURL=function(e){window.open(e.url,"_blank")};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
// getLeaderboardAsync() accepts a second property called options which supplies the following options:
//   sortOrder: "hightolow", // Sort order
function LibXtralife(){}LibXtralife.Log=function(e){console.log(e)},LibXtralife.LogError=function(e){console.log(e)},LibXtralife.prototype.Init=function(e){this.clan=Clan(e.apiKey,e.apiSecret,e.devMode);var t=localStorage.getItem("gamer");null!==t&&(this.gamerData=JSON.parse(t))},LibXtralife.prototype.InitLeaderboards=function(){},LibXtralife.prototype.InitMessaging=function(){},LibXtralife.prototype.InitReferrals=function(){},LibXtralife.prototype.InitShare=function(){},LibXtralife.prototype.InitStorage=function(){},LibXtralife.prototype.InitUser=function(){},LibXtralife.prototype.addSupportedAPI=function(e){"leaderboards"===e?(FBInstant.supportedAPIs.push("Leaderboard.getEntriesAsync"),FBInstant.supportedAPIs.push("Leaderboard.getConnectedPlayerEntriesAsync"),FBInstant.supportedAPIs.push("Leaderboard.getPlayerEntryAsync"),FBInstant.supportedAPIs.push("Leaderboard.setScoreAsync"),FBInstant.supportedAPIs.push("getLeaderboardAsync")):"messaging"===e?(FBInstant.supportedAPIs.push("ext.sendEventAsync"),FBInstant.supportedAPIs.push("ext.getEventsAsync")):"referrals"===e?(FBInstant.supportedAPIs.push("ext.getReferralCodeAsync"),FBInstant.supportedAPIs.push("ext.useReferralCodeAsync")):"storage"===e?(FBInstant.supportedAPIs.push("player.getDataAsync"),FBInstant.supportedAPIs.push("player.setDataAsync")):"user"==e&&(FBInstant.supportedAPIs.push("getLocale"),FBInstant.supportedAPIs.push("player.getConnectedPlayersAsync"),FBInstant.supportedAPIs.push("ext.isLoggedIn"),FBInstant.supportedAPIs.push("ext.getLoginType"),FBInstant.supportedAPIs.push("ext.getRegistrationDate"),FBInstant.supportedAPIs.push("ext.loginWithShortCodeAsync"),FBInstant.supportedAPIs.push("ext.loginAsync"),FBInstant.supportedAPIs.push("ext.loginWithEmailAsync"),FBInstant.supportedAPIs.push("ext.loginWithFacebookAccessTokenAsync"),FBInstant.supportedAPIs.push("ext.logoutAsync"),FBInstant.supportedAPIs.push("ext.convertAccountAsync"),FBInstant.supportedAPIs.push("ext.linkAccountAsync"),FBInstant.supportedAPIs.push("ext.resetPasswordAsync"),FBInstant.supportedAPIs.push("ext.changePasswordAsync"),FBInstant.supportedAPIs.push("ext.getGames"),FBInstant.supportedAPIs.push("ext.setProfileAsync"),FBInstant.supportedAPIs.push("ext.addFriendAsync"),FBInstant.supportedAPIs.push("ext.removeFriendAsync"),FBInstant.supportedAPIs.push("ext.listUsersAsync"))},LibXtralife.prototype.Login=function(e,t){return this.gamerData?void this.ResumeSession(this.gamerData.gamer_id,this.gamerData.gamer_secret,t):e?void this.clan.login(null,function(e,a){LibXtralife.Log(">>>> Creating new anonymous player"),null==e&&(this.gamerData=a,localStorage.setItem("gamer",JSON.stringify(a))),t!==void 0&&t(e,a)}.bind(this)):(LibXtralife.Log(">>>> Anonymous login disabled"),void(void 0!==t&&t(null,null)))},LibXtralife.prototype.ResumeSession=function(e,t,a){this.clan.resumeSession(e,t,function(e,t){LibXtralife.Log(">>>> Resuming session"),null==e&&(this.gamerData=t,localStorage.setItem("gamer",JSON.stringify(t))),a!==void 0&&a(e,t)}.bind(this))},LibXtralife.prototype.LoginWithCredentials=function(e,t,a,s){return this.gamerData?void this.ResumeSession(this.gamerData.gamer_id,this.gamerData.gamer_secret,s):void this.clan.login("email",e,t,a,function(e,t){null==e&&(this.gamerData=t,localStorage.setItem("gamer",JSON.stringify(t))),s!==void 0&&s(e,t)}.bind(this))},LibXtralife.prototype.LoginWithShortCode=function(e,t){return this.gamerData?void this.ResumeSession(this.gamerData.gamer_id,this.gamerData.gamer_secret,t):void this.clan.loginWithShortCode(e,function(e,a){null==e&&(this.gamerData=a,localStorage.setItem("gamer",JSON.stringify(a))),t!==void 0&&t(e,a)}.bind(this))},LibXtralife.prototype.LoginWithFacebook=function(e,t){return this.gamerData&&"facebook"===this.gamerData.network?void this.ResumeSession(this.gamerData.gamer_id,this.gamerData.gamer_secret,t):void this.clan.login("facebook","",e,function(e,a){null==e&&(this.gamerData=a,localStorage.setItem("gamer",JSON.stringify(a))),t!==void 0&&t(e,a)}.bind(this))},LibXtralife.prototype.Logout=function(e){this.gamerData?this.clan.withGamer(this.gamerData).logout(function(t){t||(this.gamerData=void 0),e!==void 0&&e(t)}.bind(this)):e!==void 0&&e({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibXtralife.prototype.ConvertAccount=function(e,t,a,s){this.gamerData?this.clan.withGamer(this.gamerData).convertTo(e,t,a,function(e,t){s!==void 0&&s(e,t)}.bind(this)):s!==void 0&&s({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibXtralife.prototype.LinkAccount=function(e,t,a,s){this.gamerData?(console.log("LinkAccount: "+e+", "+t+", "+a),this.clan.withGamer(this.gamerData).link(e,t,a,function(e,t){console.log("LinkAccount error: "+JSON.stringify(e)),console.log("LinkAccount result: "+JSON.stringify(t)),s!==void 0&&s(e,t)}.bind(this))):s!==void 0&&s({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibXtralife.prototype.ResetPassword=function(e,t,a,s,n){this.clan.sendResetMailPassword(e,t,a,s,function(e,t){n!==void 0&&n(e,t)}.bind(this))},LibXtralife.prototype.ChangePassword=function(e,t){this.gamerData?this.clan.withGamer(this.gamerData).changePassword(e,function(e,a){t!==void 0&&t(e,a)}.bind(this)):t!==void 0&&t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibXtralife.prototype.GetGamerData=function(){return void 0===this.gamerData?null:this.gamerData},LibXtralife.prototype.GetProfileData=function(){if(this.gamerData){var e=this.gamerData.profile;return new UserService.Player(this.gamerData.gamer_id,e.displayName,e.avatar,e.email,e.lang)}return null},LibXtralife.prototype.GetProfile=function(e){this.gamerData?this.clan.withGamer(this.gamerData).profile().get(function(t,a){e!==void 0&&e(t,a)}):e!==void 0&&e({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibXtralife.prototype.SetProfile=function(e,t){var a=this;this.gamerData?this.clan.withGamer(this.gamerData).profile().set(e,function(s,n){if(null===s)for(var r in e)a.gamerData.profile[r]=e[r];t!==void 0&&t(s,n)}):t!==void 0&&t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibXtralife.prototype.GetGames=function(){if(this.gamerData){for(var e=this.gamerData.games,a=[],s=0;s<e.length;s++)a.push(new UserService.Game(e[s].appid,e[s].appid,e[s].lastlogin,null,null));return a}return null},LibXtralife.prototype.ListUsers=function(e,t,a,s){this;this.gamerData?this.clan.withGamer(this.gamerData).listUsers(encodeURIComponent(e),a,t,function(e,t){console.log("ListUsers error: "+JSON.stringify(e)),console.log("ListUsers result: "+JSON.stringify(t)),s!==void 0&&(null===e?s(t.result):s(null))}):s!==void 0&&s(null)},LibXtralife.prototype.LeaderboardGetPaged=function(e,t,a,s,n){this;this.gamerData?this.clan.withGamer(this.gamerData).leaderboards(this.clan.privateDomain).getHighscores(t,+a,+s,function(e,a){// If the operation went wrong for some reason
if(null!==e)LibXtralife.LogError("Leaderboard Get Paged error: "+e),void 0!==n&&n(null);else{LibXtralife.Log("LeaderboardGetPaged: "+JSON.stringify(a));var s=[],r=a[t];if(r!==void 0)for(var o,s=[],i=0;i<r.scores.length;i++)o=r.scores[i],void 0!==o&&s.push(new LeaderboardsService.LbdEntry(o.gamer_id,r.rankOfFirst+i,o.profile.displayName,o.score.score,o.score.info,o.profile.avatar,o.score.timestamp));n!==void 0&&n(s)}}):n!==void 0&&n(null)},LibXtralife.prototype.LeaderboardGetFriendsPaged=function(e,t,a,s,n){this;this.gamerData?this.clan.withGamer(this.gamerData).leaderboards(this.clan.privateDomain).getFriendsHighscores(t,+a,+s,function(e,a){if(null!==e)LibXtralife.LogError("Leaderboard Get Friends Paged error: "+e),void 0!==n&&n(null);else{LibXtralife.Log("LeaderboardGetFriendsPaged: "+JSON.stringify(a));var s=[],r=a[t];if(r!==void 0)for(var o,i=0;i<r.length;i++)o=r[i],void 0!==o&&s.push(new LeaderboardsService.LbdEntry(o.gamer_id,o.rank,o.profile.displayName,o.score.score,o.score.info,o.profile.avatar,o.score.timestamp));n!==void 0&&n(s)}}):n!==void 0&&n(null)},LibXtralife.prototype.LeaderboardGetRank=function(e,t,a){var s=this;this.gamerData?this.clan.withGamer(this.gamerData).leaderboards(this.clan.privateDomain).getCenteredHighscores(t,1,function(e,n){var r=null;if(LibXtralife.Log(s.gamerData),null!==e)LibXtralife.LogError("Could not get centered rank: "+JSON.stringify(e));else{var o=n[t];if(void 0!==o){var i=o.scores[0];void 0!==i&&(LibXtralife.Log("LeaderboardGetRank: "+JSON.stringify(n)),r=new LeaderboardsService.LbdEntry(i.gamer_id,o.rankOfFirst,i.profile.displayName,i.score.score,i.score.info,i.profile.avatar,i.score.timestamp))}}void 0!==a&&a(r)}):a!==void 0&&a(null)},LibXtralife.prototype.LeaderboardSetScore=function(e,t,a,s,n){this;if(this.gamerData){this.clan.withGamer(this.gamerData).leaderboards(this.clan.privateDomain).set(t,e.options.sortOrder,{score:+a,info:s},function(e,t){null===e?(LibXtralife.Log("LeaderboardSetScore: "+JSON.stringify(t)),n!==void 0&&n(!0)):(LibXtralife.LogError("Leaderboard Set score error: "+e),n!==void 0&&n(!1))})}else void 0!==n&&n(!1)},LibXtralife.prototype.SetUserData=function(e,t,a){this.gamerData?this.clan.withGamer(this.gamerData).gamervfs(this.clan.privateDomain).setValue(e,t,function(e,t){null===e?(LibXtralife.LogError("User data set: "+t.result),a!==void 0&&a(!0)):(LibXtralife.LogError("Set user data error: "+JSON.stringify(e)),a!==void 0&&a(!1))}):a!==void 0&&a(!1)},LibXtralife.prototype.GetUserData=function(e,t){this.gamerData?this.clan.withGamer(this.gamerData).gamervfs(this.clan.privateDomain).getValue(e,function(a,s){null===a?(LibXtralife.Log("User data get: "+JSON.stringify(s)),t!==void 0&&t(s.result[e])):(LibXtralife.LogError("Get user data error: "+JSON.stringify(a)),t!==void 0&&t(null))}):t!==void 0&&t(null)},LibXtralife.prototype.GetFriends=function(e){this.gamerData?this.clan.withGamer(this.gamerData).friends(this.clan.privateDomain).get(function(t,a){if(null!==t)LibXtralife.LogError("Get friends error: "+JSON.stringify(t)),void 0!==e&&e(null);else{LibXtralife.Log("Get friends: "+JSON.stringify(a));var s=[],n=a.friends;if(n!==void 0)for(var r,o=0;o<n.length;o++)r=n[o],void 0!==r&&s.push(new UserService.Player(r.gamer_id,r.profile.displayName,r.profile.avatar,r.profile.email));e!==void 0&&e(s)}}):e!==void 0&&e(null)},LibXtralife.prototype.AddFriend=function(e,t){this.gamerData?this.clan.withGamer(this.gamerData).friends(this.clan.privateDomain).status(e,"add",function(e,a){null===e?(LibXtralife.Log("AddFriend: "+JSON.stringify(a)),t!==void 0&&t(!0)):(LibXtralife.LogError("AddFriend error: "+JSON.stringify(e)),t!==void 0&&t(!1))}):t!==void 0&&t(!1)},LibXtralife.prototype.RemoveFriend=function(e,t){this.gamerData?this.clan.withGamer(this.gamerData).friends(this.clan.privateDomain).status(e,"forget",function(e,a){null===e?(LibXtralife.Log("RemoveFriend: "+JSON.stringify(a)),t!==void 0&&t(!0)):(LibXtralife.LogError("RemoveFriend error: "+JSON.stringify(e)),t!==void 0&&t(!1))}):t!==void 0&&t(!1)},LibXtralife.prototype.SendEvent=function(e,t,a){this.gamerData===void 0?a!==void 0&&a({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"}):this.clan.withGamer(this.gamerData).events(this.clan.privateDomain).send(e,t,null,function(e,t){null===e?(LibXtralife.Log("SendEvent: "+JSON.stringify(t)),a!==void 0&&a(e,t)):(LibXtralife.LogError("SendEvent error: "+JSON.stringify(e)),a!==void 0&&a(e,t))})},LibXtralife.prototype.ListenForEvent=function(e){this.gamerData===void 0?e!==void 0&&e({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"}):this.clan.withGamer(this.gamerData).events(this.clan.privateDomain).receive("auto",function(t,a){null===t?(LibXtralife.Log("ListenForEvent: "+JSON.stringify(a)),e!==void 0&&e(t,a)):(LibXtralife.LogError("ListenForEvent error: "+JSON.stringify(t)),e!==void 0&&e(t,a))})},LibXtralife.prototype.GetAllEvents=function(e){if(void 0===this.gamerData)return void(void 0!==e&&e(null));var t=[];events_available=!0;var a=this,s=function(){a.ListenForEvent(function(a,n){null===n?e!==void 0&&e(t):(t.push(n),s())})};s()},LibXtralife.prototype.GetReferralCode=function(e){this.gamerData===void 0?e!==void 0&&e(null):this.clan.withGamer(this.gamerData).referral(this.clan.privateDomain).getCode(function(t,a){null===a?e!==void 0&&e(null):e!==void 0&&e(a.godfathercode)})},LibXtralife.prototype.UseReferralCode=function(e,t){this.gamerData===void 0?t!==void 0&&t(!1):this.clan.withGamer(this.gamerData).referral(this.clan.privateDomain).useCode(e,null,function(e){null===e?t!==void 0&&t(!0):t!==void 0&&t(!1)})};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
// Sharing options:
// type: invite - Invite another user to play { text: "message to share",  }
// type: feed - Shares messagr to users feed { text: "message to share", image: "url of feed image", params: { params to pass in to game link } }
// type: shout - Shares a shout out { text: "message to shout out", filter: "see below for detail", params: { params to pass in to game link } }
// type: private - Sends private mssage from app to user { text: "message to shout out" }
//
// filter types: "played" - people that already play the game, "not_played" - people that have not yet played the game, "list of id's" specific people, "" - everyone
//
// Chat options
// messageSentCallback - A callback which is called when a chat message is sent
// messageReceivedCallback - A callback which is called when a chat message is received
function LibKongregate(){LibKongregate.Log(">>>> Kongregate: construct"),this.loggedIn=!1,this.gamerData=null}LibKongregate.Log=function(e){console.log(e)},LibKongregate.LogError=function(e){console.log(e)},LibKongregate.prototype.Init=function(){LibKongregate.Log(">>>> Kongregate: Init");var e=this,t=function(){LibKongregate.Log(">>>> Kongregate: Logged in"),e.loggedIn=!0,e.loggedinCallback!==void 0&&e.loggedinCallback(),e.messageSentCallback=FBInstant.options.chatOptions.messageSentCallback,e.messageReceivedCallback=FBInstant.options.chatOptions.messageReceivedCallback,e.kongregate.chat.addEventListener("message",function(t){e.messageSentCallback!==void 0&&e.messageSentCallback(new ChatService.Message(t.data.message,t.data.username,"sent",null))}),e.kongregate.chat.addEventListener("room.message",function(t){e.messageReceivedCallback!==void 0&&e.messageReceivedCallback(new ChatService.Message(t.data.message,t.data.username,"recv",t.data.room))}),this.gamerData={network:"kong"}};kongregateAPI.loadAPI(function(){LibKongregate.Log(">>>> Kongregate: API Loaded"),e.kongregate=kongregateAPI.getAPI(),LibKongregate.Log(e.kongregate),e.kongregate.services.isGuest()?(LibKongregate.Log(">>>> Kongregate: Not logged in"),e.kongregate.services.addEventListener("login",function(){t()})):(LibKongregate.Log(">>>> Kongregate: Already logged in"),t())})},LibKongregate.prototype.InitAnalytics=function(){},LibKongregate.prototype.InitPayments=function(e,t){t(null)},LibKongregate.prototype.InitUser=function(){},LibKongregate.prototype.InitShare=function(){},LibKongregate.prototype.InitChat=function(){},LibKongregate.prototype.addSupportedAPI=function(e){"user"===e?(FBInstant.supportedAPIs.push("getLocale"),FBInstant.supportedAPIs.push("player.getConnectedPlayersAsync"),FBInstant.supportedAPIs.push("ext.isLoggedIn"),FBInstant.supportedAPIs.push("ext.loginAsync")):"analytics"===e?FBInstant.supportedAPIs.push("logEvent"):"share"===e?FBInstant.supportedAPIs.push("shareAsync"):"chat"===e?(FBInstant.supportedAPIs.push("ext.chatSendAsync"),FBInstant.supportedAPIs.push("ext.chatStartAsync"),FBInstant.supportedAPIs.push("ext.chatEndAsync")):"payments"==e&&(FBInstant.supportedAPIs.push("payments.getCatalogAsync"),FBInstant.supportedAPIs.push("payments.purchaseAsync"),FBInstant.supportedAPIs.push("payments.getPurchasesAsync"),FBInstant.supportedAPIs.push("payments.consumePurchaseAsync"),FBInstant.supportedAPIs.push("payments.purchaseAsync"))},LibKongregate.prototype.Login=function(e,t){this.loggedIn&&t!==void 0&&t(null,null),e?(LibKongregate.Log(">>>> Kongregate: Anonymous login"),t!==void 0&&t(null,null)):(this.loggedinCallback=function(){t!==void 0&&t(null,null)},this.kongregate.services.showRegistrationBox())},LibKongregate.prototype.GetProfileData=function(){return this.loggedIn?new UserService.Player(this.kongregate.services.getUserId(),this.kongregate.services.getUsername(),null,null,LibUtils.GetLocale()):null},LibKongregate.prototype.GetFriends=function(e){e!==void 0&&e([])},LibKongregate.prototype.LogEvent=function(e,t){return this.loggedIn?(this.kongregate.analytics.addEvent(e,{value:t}),null):{code:"ANALYTICS_POST_EXCEPTION ",message:"ANALYTICS_POST_EXCEPTION "}},LibKongregate.prototype.GetProducts=function(e){return LibKongregate.Log(">>>> Kongregate: GetProducts"),this.loggedIn?void this.kongregate.mtx.requestItemList([],function(a){if(a.success){for(var s=[],n=0;n<a.data.length;n++){var r=a.data[n],o=new PaymentsService.Product(r.name,r.id,r.description,r.image_url,r.price,"");o.identifier=r.identifier,o.tags=r.tags,s.push(o)}e(null,s)}else e({code:"NETWORK_FAILURE",message:"NETWORK_FAILURE"},null)}):void e({code:"PAYMENTS_NOT_INITIALIZED",message:"PAYMENTS_NOT_INITIALIZED"},null)},LibKongregate.prototype.PurchaseProduct=function(e,t){return LibKongregate.Log(">>>> Kongregate: PurchaseProduct"),this.loggedIn?void this.kongregate.mtx.purchaseItems([e.productID],function(a){if(LibKongregate.Log(">>>> Kongregate: purchase result"),LibKongregate.Log(a),a.success){var s=new PaymentsService.Purchase(e.developerPayload,"",e.productID,Date.now,"",null);t(null,s)}else t({code:"NETWORK_FAILURE",message:"NETWORK_FAILURE"},null)}):void t({code:"PAYMENTS_NOT_INITIALIZED",message:"PAYMENTS_NOT_INITIALIZED"},null)},LibKongregate.prototype.RefundProduct=function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"})},LibKongregate.prototype.ConsumeProduct=function(e,t){return LibKongregate.Log(">>>> Kongregate: ConsumeProduct"),this.loggedIn?void this.kongregate.mtx.useItemInstance(e,function(e){e.success?t(null):t({code:"NETWORK_FAILURE",message:"NETWORK_FAILURE"})}):void t({code:"PAYMENTS_NOT_INITIALIZED",message:"PAYMENTS_NOT_INITIALIZED"})},LibKongregate.prototype.GetPurchases=function(e){return LibKongregate.Log(">>>> Kongregate: GetPurchases"),this.loggedIn?void this.kongregate.mtx.requestUserItemList(null,function(a){if(a.success){for(var s=[],n=0;n<a.data.length;n++){var r=a.data[n],o=new PaymentsService.Purchase("",r.id,r.identifier,null,r.id,null);o.data=r.data,o.remainingUses=r.remaining_uses,s.push(o)}e(null,s)}else e({code:"NETWORK_FAILURE",message:"NETWORK_FAILURE"},null)}):void e({code:"PAYMENTS_NOT_INITIALIZED",message:"PAYMENTS_NOT_INITIALIZED"},null)},LibKongregate.prototype.ShowPurchaseDialog=function(e){return LibKongregate.Log(">>>> Kongregate: ShowPurchaseDialog"),this.loggedIn?void this.kongregate.mtx.showKredPurchaseDialog(e.type):void done_cb({code:"PAYMENTS_NOT_INITIALIZED",message:"PAYMENTS_NOT_INITIALIZED"},null)},LibKongregate.prototype.SharePrimary=function(e){LibKongregate.Log(">>>> Kongregate: SharePrimary"),LibKongregate.Log(e),"feed"===e.type?this.kongregate.services.showFeedPostBox({content:e.text,image_url:e.image,kv_params:e.data},function(){}):"shout"===e.type?this.kongregate.services.showShoutBox(e.text,function(){}):"private"===e.type?this.kongregate.services.privateMessage(e.text):this.kongregate.services.showInvitationBox({content:e.text,filter:e.filter,kv_params:e.data},function(e){LibKongregate.Log(">>>> Kongregate: invite Result"),console.log(e)})},LibKongregate.prototype.OpenURL=function(e){window.open(e.url,"_blank")},LibKongregate.prototype.SendStat=function(e){return(LibKongregate.Log(">>>> Kongregate: SendStat"),!!this.loggedIn)&&(this.kongregate.stats.submit(e.stat,e.value),!0)},LibKongregate.prototype.StartChat=function(e){return(LibKongregate.Log(">>>> Kongregate: StartChat"),LibKongregate.Log(e),!!this.loggedIn)&&(this.kongregate.chat.showTab(e.name,e.description,e.options),!0)},LibKongregate.prototype.EndChat=function(){return(LibKongregate.Log(">>>> Kongregate: EndChat"),!!this.loggedIn)&&(this.kongregate.chat.closeTab(),!0)},LibKongregate.prototype.SendChatMessage=function(e){return(LibKongregate.Log(">>>> Kongregate: SendChatMessage"),!!this.loggedIn)&&(this.kongregate.chat.displayMessage(e.message,e.username),!0)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibCrazyGames(){// NOTES:
// Preloading is not supported
// Interstitial is supported
// Rewarded is supported
}LibCrazyGames.Log=function(e){console.log(e)},LibCrazyGames.LogError=function(e){console.log(e)},LibCrazyGames.prototype.InitAds=function(e){LibCrazyGames.Log(">>>> CrazyGames: InitAds");var t=this;this.crazysdk=window.CrazyGames.CrazySDK.getInstance(),this.adRequested=!1,this.startedCallback=e.startedCallback,this.finishedCallback=e.finishedCallback,this.crazysdk.init(),this.crazysdk.addEventListener("adStarted",function(){LibCrazyGames.Log("CrazyGames: adStarted"),t.startedCallback&&t.startedCallback()}),this.crazysdk.addEventListener("adError",function(){LibCrazyGames.Log("CrazyGames: adError"),t.adRequested=!1,t.finishedCallback&&t.finishedCallback(!1),t.watchedCallback&&t.watchedCallback({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}),t.watchedCallback=void 0}),this.crazysdk.addEventListener("adFinished",function(){LibCrazyGames.Log("CrazyGames: adFinished"),t.adRequested=!1,t.finishedCallback&&t.finishedCallback(!0),t.watchedCallback&&t.watchedCallback(null),t.watchedCallback=void 0})},LibCrazyGames.prototype.addSupportedAPI=function(e){"ads"===e&&(FBInstant.supportedAPIs.push("getInterstitialAdAsync"),FBInstant.supportedAPIs.push("getRewardedVideoAsync"),FBInstant.supportedAPIs.push("AdInstance.loadAsync"),FBInstant.supportedAPIs.push("AdInstance.showAsync"))},LibCrazyGames.prototype.PreloadAd=function(e,t,a){a(null)},LibCrazyGames.prototype.ShowAd=function(e,t,a){this.adRequested&&(LibCrazyGames.Log("CrazyGames: Ad already requested"),a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"})),LibCrazyGames.Log("CrazyGames: Requesting ad"),this.adRequested=!0,"video"===t?(this.watchedCallback=a,this.crazysdk.requestAd("rewarded")):"inter"===t?(this.watchedCallback=a,this.crazysdk.requestAd("midgame")):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"})};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibGameDistribution(){LibGameDistribution.Log(">>>> GameDistribution: Created!")}LibGameDistribution.Log=function(e){console.log(e)},LibGameDistribution.LogError=function(e){console.log(e)},LibGameDistribution.prototype.InitAds=function(e){LibGameDistribution.Log(">>>> GameDistribution: InitAds");var t=this;this.startedCallback=e.startedCallback,this.finishedCallback=e.finishedCallback,window.GD_OPTIONS={gameId:e.appId,onEvent:function(e){switch(e.name){case"SDK_GAME_START":LibGameDistribution.Log("GameDistribution: adFinished"),t.finishedCallback&&t.finishedCallback(),t.watchedCallback&&t.watchedCallback(null),t.watchedCallback=void 0;break;case"SDK_GAME_PAUSE":LibGameDistribution.Log("GameDistribution: adStarted"),t.startedCallback&&t.startedCallback();break;case"AD_ERROR":LibGameDistribution.Log("GameDistribution: adError"),t.finishedCallback&&t.finishedCallback(!1),t.watchedCallback&&t.watchedCallback({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}),t.watchedCallback=void 0;break;case"SDK_ERROR":LibGameDistribution.LogError("GameDistribution: SDK ERROR");break;case"SDK_GDPR_TRACKING":// this event is triggered when your user doesn't want to be tracked
break;case"SDK_GDPR_TARGETING":}}};var a=document.createElement("script");a.id="gamedistribution-jssdk",a.src="https://html5.api.gamedistribution.com/main.min.js",a.onload=function(){LibGameDistribution.Log(">>>> GameDistribution: Loaded")},document.head.appendChild(a)},LibGameDistribution.prototype.addSupportedAPI=function(e){"ads"===e&&(FBInstant.supportedAPIs.push("getInterstitialAdAsync"),FBInstant.supportedAPIs.push("getRewardedVideoAsync"),FBInstant.supportedAPIs.push("AdInstance.loadAsync"),FBInstant.supportedAPIs.push("AdInstance.showAsync"))},LibGameDistribution.prototype.PreloadAd=function(e,t,a){a(null)},LibGameDistribution.prototype.ShowAd=function(e,t,a){return LibGameDistribution.Log("GameDistribution: Requesting ad"),void 0===gdsdk?void a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}):void("video"===t?(this.watchedCallback=a,gdsdk.showBanner()):"inter"===t?(gdsdk.showBanner(),a(null)):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}))};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibAdInPlay(){// NOTES:
// Preloading is not supported
// Interstitial is supported
// Rewarded is supported
}LibAdInPlay.Log=function(e){console.log(e)},LibAdInPlay.LogError=function(e){console.log(e)},LibAdInPlay.prototype.InitAds=function(e){LibAdInPlay.Log("LibAdInPlay: InitAds"),this.adWidth=960,this.adHeight=540,e.adWidth!==void 0&&(this.adWidth=e.adWidth),e.adHeight!==void 0&&(this.adHeight=e.adHeight),this.startedCallback=e.startedCallback,this.finishedCallback=e.finishedCallback},LibAdInPlay.prototype.addSupportedAPI=function(e){"ads"===e&&(FBInstant.supportedAPIs.push("getInterstitialAdAsync"),FBInstant.supportedAPIs.push("getRewardedVideoAsync"),FBInstant.supportedAPIs.push("AdInstance.loadAsync"),FBInstant.supportedAPIs.push("AdInstance.showAsync"))},LibAdInPlay.prototype.PreloadAd=function(e,t,a){a(null)},LibAdInPlay.prototype.ShowAd=function(e,t,a){LibAdInPlay.Log("LibAdInPlay: Requesting ad");var s=this;return void 0===this.aiptag&&(this.aiptag=aiptag||{},this.aiptag.cmd=this.aiptag.cmd||[],this.aiptag.cmd.player=this.aiptag.cmd.player||[],this.aiptag.consented=!0,this.aiptag.cmd.player.push(function(){adplayer=new aipPlayer({AD_WIDTH:s.adWidth,AD_HEIGHT:s.adHeight,AD_FULLSCREEN:!1,AD_CENTERPLAYER:!1,LOADING_TEXT:"loading advertisement",PREROLL_ELEM:function(){return document.getElementById("preroll")},AIP_COMPLETE:function(){LibAdInPlay.Log("AdInPlay: adFinished"),s.adRequested=!1,void 0!==s.finishedCallback&&s.finishedCallback(!0),void 0!==s.watchedCallback&&s.watchedCallback(null),s.watchedCallback=void 0},AIP_REMOVE:function(){// Here it's save to remove the PREROLL_ELEM from the page.
// But it's not necessary.
}})})),void 0===this.aiptag?void a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}):void("video"===t?(this.watchedCallback=a,this.aiptag.cmd.player.push(function(){adplayer.startPreRoll()}),void 0!==this.startedCallback&&this.startedCallback()):"inter"===t?(this.aiptag.cmd.player.push(function(){adplayer.startPreRoll()}),a(null),void 0!==this.startedCallback&&this.startedCallback()):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}))};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibGoogleAnalytics(){LibGoogleAnalytics.Log(">>>> GoogleAnalytics: Created!")}LibGoogleAnalytics.Log=function(e){console.log(e)},LibGoogleAnalytics.LogError=function(e){console.log(e)},LibGoogleAnalytics.prototype.InitAnalytics=function(e){LibGoogleAnalytics.Log(">>>> GoogleAnalytics: InitAnalytics");this;(function(e,t,s,n,o,r,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,r=t.createElement(s),i=t.getElementsByTagName(s)[0],r.async=1,r.src=n,i.parentNode.insertBefore(r,i)})(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create",e.trackingId,"auto")},LibGoogleAnalytics.prototype.addSupportedAPI=function(e){"analytics"===e&&FBInstant.supportedAPIs.push("logEvent")},LibGoogleAnalytics.prototype.LogEvent=function(e,t){return LibGoogleAnalytics.Log(">>>> GoogleAnalytics: LogEvent "+e),ga("send","event","game",e,t),!0};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibPayPal(){LibPayPal.Log(">>>> GoogleAnalytics: Created!")}LibPayPal.Log=function(e){console.log(e)},LibPayPal.LogError=function(e){console.log(e)},FBInstant.options.paymentsOptions.style={size:"responsive",color:"blue",shape:"pill",label:"checkout",tagline:"true"},FBInstant.options.paymentsOptions.locale="en_US",FBInstant.options.paymentsOptions.currency="USD",FBInstant.options.paymentsOptions.buttonId="#paypal-button",FBInstant.options.paymentsOptions.products={},LibPayPal.prototype.InitPayments=function(e,t){LibPayPal.Log(">>>> PayPal: InitPayments"),t(null)},LibPayPal.prototype.addSupportedAPI=function(e){"payments"===e&&(FBInstant.supportedAPIs.push("payments.getCatalogAsync"),FBInstant.supportedAPIs.push("payments.purchaseAsync"),FBInstant.supportedAPIs.push("payments.getPurchasesAsync"),FBInstant.supportedAPIs.push("payments.consumePurchaseAsync"),FBInstant.supportedAPIs.push("payments.purchaseAsync"))},LibPayPal.prototype.GetProducts=function(e){e(null,FBInstant.options.paymentsOptions.products)},LibPayPal.prototype.PurchaseProduct=function(e,t){var a=FBInstant.options.paymentsOptions;LibPayPal.Log(">>>> PayPal: PurchaseProduct - env "+a.devMode);var s=a.products[e.productID];return void 0===s?void t({code:"INVALID_PARAM",message:"INVALID_PARAM"},null):void paypal.Button.render({// Configure environment
env:a.devMode,client:{sandbox:a.sandboxId,production:a.productionId},// Customize button (optional)
locale:a.locale,style:a.style,// Set up a payment
payment:function(e,t){return t.payment.create({transactions:[{amount:{total:""+s.price,currency:s.priceCurrencyCode},description:s.description}]})},onAuthorize:function(a,n){return n.payment.execute().then(function(){var n=new PaymentsService.Purchase(e.developerPayload,a.paymentID,s.productID,Date.now,a.paymentToken,null);n.orderID=a.orderID,n.returnUrl=a.returnUrl,t(null,a)})},onCancel:function(){t({code:"USER_INPUT",message:"USER_INPUT"},null)}},a.buttonId)},LibPayPal.prototype.RefundProduct=function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"},null)},LibPayPal.prototype.ConsumeProduct=function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"},null)},LibPayPal.prototype.GetPurchases=function(e){e({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"},null)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibUnity(){LibUnity.Log(">>>> Unity: construct"),this.iap_init=!1,this.profile=new UserService.Player("User","","","","us"),this.gamerData=null}LibUnity.Log=function(e){console.log(e)},LibUnity.LogError=function(e){console.log(e)},LibUnity.MessageQ=[],LibUnity.MessageQSendInterval=50,LibUnity.SendMessages=function(){0<LibUnity.MessageQ.length&&(window.location.href="igx://"+LibUnity.MessageQ[0],LibUnity.MessageQ.shift())},setInterval(LibUnity.SendMessages,LibUnity.MessageQSendInterval),LibUnity.SendMessageToUnity=function(e){LibUnity.MessageQ.push(e)},LibUnity.ShowAdCallback=function(e){LibUnity.Log(">>>> Unity: ShowAdCallback "+e);var t=AdsService.instance.service;if("ok"===e){var a=t.watchedCallback;a!==void 0&&a(null),t.finishedCallback!==void 0&&t.finishedCallback(!0),t.watchedCallback=void 0}else if("error"===e||"skip"===e){var a=t.watchedCallback;a!==void 0&&a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}),t.finishedCallback!==void 0&&t.finishedCallback(!1),t.watchedCallback=void 0}},LibUnity.LoadAdCallback=function(e){LibUnity.Log(">>>> Unity: LoadAdCallback "+e);var t=AdsService.instance.service;"ok"===e?(t.loadCallback!==void 0&&t.loadCallback(null,null),t.loadCallback=void 0):"error"==e&&(t.loadCallback!==void 0&&t.loadCallback({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}),t.loadCallback=void 0)},LibUnity.LoadRewardedAdCallback=function(e){LibUnity.Log(">>>> Unity: LoadAdCallback "+e);var t=AdsService.instance.service;"ok"===e?(t.loadRewardedCallback!==void 0&&t.loadRewardedCallback(null,null),t.loadRewardedCallback=void 0):"error"==e&&(t.loadRewardedCallback!==void 0&&t.loadRewardedCallback({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}),t.loadRewardedCallback=void 0)},LibUnity.IAPCallback=function(e,a){LibUnity.Log(">>>> Unity: IAPCallback "+e);var s=PaymentsService.instance.service;if("success"===e){// Upate product prices
var n=FBInstant.options.paymentsOptions.products;for(var r in n)for(var o=0;o<a.length;o++)n[r].productID===a[o].id&&(n[r].price=a[o].price);s.iap_init=!0,s.iap_initialised(null)}else"error"===e&&(s.iap_init=!1,s.iap_initialised())},LibUnity.PurchaseCallback=function(e,t){LibUnity.Log(">>>> Unity: PurchaseCallback "+e);var a=PaymentsService.instance.service;"success"===e?a.purchase_complete!==void 0&&(a.purchase_complete(null,new PaymentsService.Purchase("","",t,Date.now,"",null)),a.purchase_complete=void 0):"error"==e&&a.purchase_complete!==void 0&&(a.purchase_complete({code:"NETWORK_FAILURE",message:"NETWORK_FAILURE"},null),a.purchase_complete=void 0)},LibUnity.LoginCallback=function(e,t){LibUnity.Log(">>>> Unity: LoginCallback "+e);var a=UserService.instance.service;a.login_complete!==void 0&&(e?(a.gamerData={network:"unity"},a.login_complete(null,t)):a.login_complete({code:"NETWORK_FAILURE",message:"NETWORK_FAILURE"},t),a.login_complete=void 0,a.profile=t)},LibUnity.SetScoreCallback=function(e){LibUnity.Log(">>>> Unity: SubmitScoreCallback");var t=LeaderboardsService.instance.service;t.setscore_complete!==void 0&&(t.setscore_complete(e),t.setscore_complete=void 0)},LibUnity.LoadPlayerScoreCallback=function(e){LibUnity.Log(">>>> Unity: LoadPlayerScoreCallback");var t=LeaderboardsService.instance.service;t.getscore_complete!==void 0&&(null===e?t.getscore_complete(null):t.getscore_complete(e),t.getscore_complete=void 0)},LibUnity.LoadScoresCallback=function(e){LibUnity.Log(">>>> Unity: LoadScoresCallback");var t=LeaderboardsService.instance.service;t.loadscores_complete!==void 0&&(null===e?t.loadscores_complete(null):t.loadscores_complete(e),t.loadscores_complete=void 0)},LibUnity.SetLocale=function(e){var t=UserService.instance.service;t.profile.lang=e},LibUnity.prototype.Init=function(){LibUnity.Log(">>>> Unity: Init"),LibUnity.SendMessageToUnity("init")},LibUnity.prototype.InitAds=function(e){LibUnity.Log(">>>> Unity: InitAds"),this.startedCallback=e.startedCallback,this.finishedCallback=e.finishedCallback,LibUnity.SendMessageToUnity("initAds"+e.vendor+","+e.appId)},LibUnity.prototype.InitAnalytics=function(){},LibUnity.prototype.InitPayments=function(e,t){LibUnity.Log(">>>> Unity: InitPayments");this;this.iap_initialised=t;var a=FBInstant.options.paymentsOptions.products,s="";for(var n in a)s+=a[n].productID+",";LibUnity.SendMessageToUnity("initIAP"+s)},LibUnity.prototype.InitUser=function(){LibUnity.Log(">>>> Unity: InitUser"),LibUnity.SendMessageToUnity("initSocial")},LibUnity.prototype.InitLeaderboards=function(){},LibUnity.prototype.InitShare=function(){},LibUnity.prototype.addSupportedAPI=function(e){"leaderboards"===e?(FBInstant.supportedAPIs.push("Leaderboard.getEntriesAsync"),FBInstant.supportedAPIs.push("Leaderboard.getConnectedPlayerEntriesAsync"),FBInstant.supportedAPIs.push("Leaderboard.getPlayerEntryAsync"),FBInstant.supportedAPIs.push("Leaderboard.setScoreAsync"),FBInstant.supportedAPIs.push("getLeaderboardAsync"),FBInstant.supportedAPIs.push("ext.showLeaderboard")):"user"===e?(FBInstant.supportedAPIs.push("getLocale"),FBInstant.supportedAPIs.push("player.getConnectedPlayersAsync"),FBInstant.supportedAPIs.push("ext.isLoggedIn"),FBInstant.supportedAPIs.push("ext.loginAsync")):"share"===e?FBInstant.supportedAPIs.push("shareAsync"):"ads"===e?(FBInstant.supportedAPIs.push("getInterstitialAdAsync"),FBInstant.supportedAPIs.push("getRewardedVideoAsync"),FBInstant.supportedAPIs.push("AdInstance.loadAsync"),FBInstant.supportedAPIs.push("AdInstance.showAsync")):"analytics"===e?FBInstant.supportedAPIs.push("logEvent"):"payments"===e?(FBInstant.supportedAPIs.push("payments.getCatalogAsync"),FBInstant.supportedAPIs.push("payments.purchaseAsync"),FBInstant.supportedAPIs.push("payments.getPurchasesAsync"),FBInstant.supportedAPIs.push("payments.consumePurchaseAsync"),FBInstant.supportedAPIs.push("payments.purchaseAsync")):"debug"==e&&(FBInstant.supportedAPIs.push("ext.debug.show"),FBInstant.supportedAPIs.push("ext.debug.log"))},LibUnity.prototype.Login=function(e,t){e?(LibUnity.Log(">>>> LibUnity: Anonymous login"),t!==void 0&&t(null,null)):(this.login_complete=t,LibUnity.SendMessageToUnity("login"))},LibUnity.prototype.GetProfileData=function(){return this.profile},LibUnity.prototype.SetProfile=function(e){this.profile=e},LibUnity.prototype.GetFriends=function(e){e!==void 0&&e([])},LibUnity.prototype.PreloadAd=function(e,t,a){LibUnity.Log("Unity: Loading ad"),"video"===t?(this.loadRewardedCallback=a,LibUnity.SendMessageToUnity("loadVideo")):"inter"===t?(this.loadCallback=a,LibUnity.SendMessageToUnity("loadInter")):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"})},LibUnity.prototype.ShowAd=function(e,t,a){LibUnity.Log("Unity: Showing ad"),"video"===t?(this.watchedCallback=a,LibUnity.SendMessageToUnity("showVideo"),this.startedCallback!==void 0&&this.startedCallback()):"inter"===t?(LibUnity.SendMessageToUnity("showInter"),a(null),this.startedCallback!==void 0&&this.startedCallback()):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"})},LibUnity.prototype.LogEvent=function(e,t,a){var s="logEvent"+e;for(var n in a)s+=","+n+","+a[n];return LibUnity.SendMessageToUnity(s),null},LibUnity.prototype.GetProducts=function(e){e(null,FBInstant.options.paymentsOptions.products)},LibUnity.prototype.PurchaseProduct=function(e,t){if(!this.iap_init)return void t({code:"PAYMENTS_NOT_INITIALIZED",message:"PAYMENTS_NOT_INITIALIZED"},null);FBInstant.options.paymentsOptions;this.purchase_complete=t,LibUnity.SendMessageToUnity("purchase"+e.productID)},LibUnity.prototype.RefundProduct=function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"},null)},LibUnity.prototype.ConsumeProduct=function(e,t){t({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"},null)},LibUnity.prototype.GetPurchases=function(e){e({code:"CLIENT_UNSUPPORTED_OPERATION",message:"CLIENT_UNSUPPORTED_OPERATION"},null)},LibUnity.prototype.LeaderboardGetPaged=function(e,t,a,s,n){this.loadscores_complete=n,LibUnity.SendMessageToUnity("scores"+t+",global")},LibUnity.prototype.LeaderboardGetFriendsPaged=function(e,t,a,s,n){this.loadscores_complete=n,LibUnity.SendMessageToUnity("scores"+t+",friends")},LibUnity.prototype.LeaderboardGetRank=function(e,t,a){this.getscore_complete=a,LibUnity.SendMessageToUnity("getscore"+t)},LibUnity.prototype.LeaderboardSetScore=function(e,t,a,s,n){this.setscore_complete=n,LibUnity.SendMessageToUnity("setscore"+t+","+a)},LibUnity.prototype.ShowLeaderboard=function(){LibUnity.SendMessageToUnity("showlbd")},LibUnity.prototype.SharePrimary=function(e){if(e.image!==void 0){var t=e.image.replace(/^data:image\/(png|jpeg);base64,/,"");// Upload the image
t=t.replace(/\+/g,"$");// // WebView strips out + signs so we have to replace them then put them back Unity side
var a=t.length;console.log("########## Total len "+a);for(var s=0;0<a;)15000>a?LibUnity.SendMessageToUnity("ud"+t.substr(s,a)):LibUnity.SendMessageToUnity("ud"+t.substr(s,15000)),s+=15000,a-=15000,console.log("########## "+a);LibUnity.SendMessageToUnity("share"+e.title+","+e.text+",image")}else LibUnity.SendMessageToUnity("share"+e.title+","+e.text+",")},LibUnity.prototype.OpenURL=function(e){LibUnity.SendMessageToUnity("openurl"+e.url)},LibUnity.prototype.ShowDebug=function(e){!0===e?LibUnity.SendMessageToUnity("showdbg1"):LibUnity.SendMessageToUnity("showdbg0")},LibUnity.prototype.ClearDebug=function(){LibUnity.SendMessageToUnity("clog")},LibUnity.prototype.LogDebug=function(e){LibUnity.SendMessageToUnity("dlog"+e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function LibPoki(){// NOTES:
// Preloading is not supported
// Interstitial is supported
// Rewarded is supported
}LibPoki.Log=function(e){console.log(e)},LibPoki.LogError=function(e){console.log(e)},LibPoki.prototype.Init=function(){LibPoki.Log(">>>> Poki: Init");var e=function(){PokiSDK.gameLoadingStart()};PokiSDK.init().then(e).catch(()=>{LibPoki.Log(">>>> adblock"),e()})},LibPoki.prototype.InitAds=function(e){LibPoki.Log(">>>> Poki: InitAds"),this.adfinished_callback=e.finishedCallback,this.adstarted_callback=e.startedCallback},LibPoki.prototype.addSupportedAPI=function(e){"ads"===e&&(FBInstant.supportedAPIs.push("getInterstitialAdAsync"),FBInstant.supportedAPIs.push("getRewardedVideoAsync"),FBInstant.supportedAPIs.push("AdInstance.loadAsync"),FBInstant.supportedAPIs.push("AdInstance.showAsync"),FBInstant.supportedAPIs.push("setLoadingProgress"))},LibPoki.prototype.SetLoadingProgress=function(e){PokiSDK.gameLoadingProgress({percentageDone:e/10})},LibPoki.prototype.FinishedLoading=function(){PokiSDK.gameLoadingFinished()},LibPoki.prototype.PreloadAd=function(e,t,a){a(null)},LibPoki.prototype.ShowAd=function(e,t,a){LibPoki.Log("Poki: Requesting ad");var s=this;"video"===t?(this.adstarted_callback&&this.adstarted_callback(),PokiSDK.rewardedBreak().then(e=>{LibPoki.Log("Poki: rewarded ad done "+e),e?a(null):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"}),s.adfinished_callback&&s.adfinished_callback()})):"inter"===t?(this.adstarted_callback&&this.adstarted_callback(),PokiSDK.commercialBreak().then(()=>{LibPoki.Log("Poki: inter ad done"),a(null),s.adfinished_callback&&s.adfinished_callback()})):a({code:"ADS_NOT_LOADED",message:"ADS_NOT_LOADED"})},LibPoki.prototype.GameEvent=function(e){"gameplayStart"===e.type?PokiSDK.gameplayStart():"gameplayStop"===e.type?PokiSDK.gameplayStop():"happyTime"===e.type&&PokiSDK.happyTime(e.value)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function AdsService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("crazygames"===e?this.service=new LibCrazyGames:"poki"===e?this.service=new LibPoki:"gamedistribution"===e?this.service=new LibGameDistribution:"adinplay"===e?this.service=new LibAdInPlay:"unity"==e&&(this.service=new LibUnity)),this.name=e,AdsService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("ads")}//
// INIT
//
AdsService.prototype.InitAds=function(e){return void 0!==this.service&&this.service.InitAds(e)},AdsService.prototype.IsSupported=function(){return this.service!==void 0},AdsService.prototype.PreloadAd=function(e,t,a){return void 0===this.service?void 0:this.service.PreloadAd(e,t,a)},AdsService.prototype.ShowAd=function(e,t,a){return void 0===this.service?void 0:this.service.ShowAd(e,t,a)},PaymentsService.Product=function(e,t,a,s,n,r){this.title=e,this.productID=t,this.description=a,this.imageURI=s,this.price=n,this.priceCurrencyCode=r},PaymentsService.Purchase=function(e,t,a,s,n,r){this.developerPayload=e,this.paymentID=t,this.productID=a,this.purchaseTime=s,this.purchaseToken=n,this.signedRequest=r};function PaymentsService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("paypal"===e?this.service=new LibPayPal:"kongregate"===e?this.service=new LibKongregate:"unity"==e&&(this.service=new LibUnity)),this.name=e,PaymentsService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("payments")}//
// INIT
//
PaymentsService.prototype.InitPayments=function(e,t){return void 0!==this.service&&this.service.InitPayments(e,t)},PaymentsService.prototype.IsSupported=function(){return this.service!==void 0},PaymentsService.prototype.GetProducts=function(e){return void 0===this.service?void 0:this.service.GetProducts(e)},PaymentsService.prototype.PurchaseProduct=function(e,t){return void 0===this.service?void 0:this.service.PurchaseProduct(e,t)},PaymentsService.prototype.RefundProduct=function(e,t){return void 0===this.service?void 0:this.service.RefundProduct(e,t)},PaymentsService.prototype.ConsumeProduct=function(e,t){return void 0===this.service?void 0:this.service.ConsumeProduct(e,t)},PaymentsService.prototype.GetPurchases=function(e){return void 0===this.service?void 0:this.service.GetPurchases(e)};//
// Copyright (C) Mat Hopwood www.drmop.com
// For details of license see license.txt
//
function AnalyticsService(e){this.service=LibUtils.ResolveService(e),this.service===void 0&&("google"===e?this.service=new LibGoogleAnalytics:"kongregate"===e?this.service=new LibKongregate:"unity"==e&&(this.service=new LibUnity)),this.name=e,AnalyticsService.instance=this,FBInstant.ext!==void 0&&this.service!==void 0&&this.service.addSupportedAPI("analytics")}//
// INIT
//
//
// Logging
//
AnalyticsService.prototype.InitAnalytics=function(e){return void 0!==this.service&&this.service.InitAnalytics(e)},AnalyticsService.prototype.IsSupported=function(){return this.service!==void 0},AnalyticsService.prototype.LogEvent=function(e,t,a){return void 0===this.service?null:this.service.LogEvent(e,t,a)};